<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AceTMI: ace_tmi::SimpleTmiFastInterface&lt; T_DIO_PIN, T_CLK_PIN, T_DELAY_MICROS &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AceTMI
   &#160;<span id="projectnumber">0.3</span>
   </div>
   <div id="projectbrief">Unified interface for selecting different implementations for communicating with a TM1637 LED controller chip on Arduino platforms</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>ace_tmi</b></li><li class="navelem"><a class="el" href="classace__tmi_1_1SimpleTmiFastInterface.html">SimpleTmiFastInterface</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classace__tmi_1_1SimpleTmiFastInterface-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">ace_tmi::SimpleTmiFastInterface&lt; T_DIO_PIN, T_CLK_PIN, T_DELAY_MICROS &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Exactly the same as <a class="el" href="classace__tmi_1_1SimpleTmiInterface.html" title="Class that knows how to communicate with a TM1637 chip.">SimpleTmiInterface</a> except that this uses the <code>digitalWriteFast</code> library on AVR processors.  
 <a href="classace__tmi_1_1SimpleTmiFastInterface.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="SimpleTmiFastInterface_8h_source.html">SimpleTmiFastInterface.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a59d6773b94d1e127d7c7651efe48d39a"><td class="memItemLeft" align="right" valign="top"><a id="a59d6773b94d1e127d7c7651efe48d39a"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classace__tmi_1_1SimpleTmiFastInterface.html#a59d6773b94d1e127d7c7651efe48d39a">SimpleTmiFastInterface</a> ()=default</td></tr>
<tr class="memdesc:a59d6773b94d1e127d7c7651efe48d39a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor. <br /></td></tr>
<tr class="separator:a59d6773b94d1e127d7c7651efe48d39a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a988aa1e7815f234a171b8bce82ee945d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classace__tmi_1_1SimpleTmiFastInterface.html#a988aa1e7815f234a171b8bce82ee945d">begin</a> () const</td></tr>
<tr class="memdesc:a988aa1e7815f234a171b8bce82ee945d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the dio and clk pins.  <a href="classace__tmi_1_1SimpleTmiFastInterface.html#a988aa1e7815f234a171b8bce82ee945d">More...</a><br /></td></tr>
<tr class="separator:a988aa1e7815f234a171b8bce82ee945d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac62c4931c0f813cb9c002da564d12e68"><td class="memItemLeft" align="right" valign="top"><a id="ac62c4931c0f813cb9c002da564d12e68"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classace__tmi_1_1SimpleTmiFastInterface.html#ac62c4931c0f813cb9c002da564d12e68">end</a> () const</td></tr>
<tr class="memdesc:ac62c4931c0f813cb9c002da564d12e68"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set dio and clk pins to INPUT mode. <br /></td></tr>
<tr class="separator:ac62c4931c0f813cb9c002da564d12e68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc60e6299e2a9906150f12a08a78c0f6"><td class="memItemLeft" align="right" valign="top"><a id="afc60e6299e2a9906150f12a08a78c0f6"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classace__tmi_1_1SimpleTmiFastInterface.html#afc60e6299e2a9906150f12a08a78c0f6">startCondition</a> () const</td></tr>
<tr class="memdesc:afc60e6299e2a9906150f12a08a78c0f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate the I2C-like start condition. <br /></td></tr>
<tr class="separator:afc60e6299e2a9906150f12a08a78c0f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16b97f7f7dc1abbb865e33436e674147"><td class="memItemLeft" align="right" valign="top"><a id="a16b97f7f7dc1abbb865e33436e674147"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classace__tmi_1_1SimpleTmiFastInterface.html#a16b97f7f7dc1abbb865e33436e674147">stopCondition</a> () const</td></tr>
<tr class="memdesc:a16b97f7f7dc1abbb865e33436e674147"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate the I2C-like stop condition. <br /></td></tr>
<tr class="separator:a16b97f7f7dc1abbb865e33436e674147"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f47efb6173c6dc0fa8d08d5260749de"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classace__tmi_1_1SimpleTmiFastInterface.html#a5f47efb6173c6dc0fa8d08d5260749de">write</a> (uint8_t data) const</td></tr>
<tr class="memdesc:a5f47efb6173c6dc0fa8d08d5260749de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send the data byte on the data bus, with LSB first instead of the usual MSB first for I2C.  <a href="classace__tmi_1_1SimpleTmiFastInterface.html#a5f47efb6173c6dc0fa8d08d5260749de">More...</a><br /></td></tr>
<tr class="separator:a5f47efb6173c6dc0fa8d08d5260749de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07f09645f64e75d73c480ff5561bbc35"><td class="memItemLeft" align="right" valign="top"><a id="a07f09645f64e75d73c480ff5561bbc35"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>SimpleTmiFastInterface</b> (const <a class="el" href="classace__tmi_1_1SimpleTmiFastInterface.html">SimpleTmiFastInterface</a> &amp;)=default</td></tr>
<tr class="separator:a07f09645f64e75d73c480ff5561bbc35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53575b2f1971124965d603a4de4675f9"><td class="memItemLeft" align="right" valign="top"><a id="a53575b2f1971124965d603a4de4675f9"></a>
<a class="el" href="classace__tmi_1_1SimpleTmiFastInterface.html">SimpleTmiFastInterface</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>operator=</b> (const <a class="el" href="classace__tmi_1_1SimpleTmiFastInterface.html">SimpleTmiFastInterface</a> &amp;)=default</td></tr>
<tr class="separator:a53575b2f1971124965d603a4de4675f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;uint8_t T_DIO_PIN, uint8_t T_CLK_PIN, uint8_t T_DELAY_MICROS&gt;<br />
class ace_tmi::SimpleTmiFastInterface&lt; T_DIO_PIN, T_CLK_PIN, T_DELAY_MICROS &gt;</h3>

<p>Exactly the same as <a class="el" href="classace__tmi_1_1SimpleTmiInterface.html" title="Class that knows how to communicate with a TM1637 chip.">SimpleTmiInterface</a> except that this uses the <code>digitalWriteFast</code> library on AVR processors. </p>
<p>Normally, the digitalWriteFast library is used to get faster speeds over <code>digitalWrite()</code> and <code>pinMode()</code> functions. But speed of the <code>digitalWrite()</code> functions is not the limiting factor in this library because every bit flip is followed by a <code>delayMicroseconds()</code> which is far longer than the CPU cycle savings from <code>digitalWritFast()</code>.</p>
<p>The reason that you may want to use <code>digitalWriteFast</code> library is because it consumes far less flash memory than normal <code>digitalWrite()</code>. The benchmarks in MemoryBenchmark shows that using this <code><a class="el" href="classace__tmi_1_1SimpleTmiFastInterface.html" title="Exactly the same as SimpleTmiInterface except that this uses the digitalWriteFast library on AVR proc...">SimpleTmiFastInterface</a></code> instead of <code><a class="el" href="classace__tmi_1_1SimpleTmiInterface.html" title="Class that knows how to communicate with a TM1637 chip.">SimpleTmiInterface</a></code> saves 650-770 bytes of flash on an AVR processor.</p>
<p>Word of caution: There is a use-case where the normal <code><a class="el" href="classace__tmi_1_1SimpleTmiInterface.html" title="Class that knows how to communicate with a TM1637 chip.">SimpleTmiInterface</a></code> might consume less flash memory. If your application uses more than one TM1637 LED Module, you will need to create multiple instances of the <code>Tm1637Module</code>. But the pin numbers of this class must be a compile-time constants, so different pins means that a different template class is generated. Since the <code>Tm1637Module</code> class takes a <code><a class="el" href="classace__tmi_1_1SimpleTmiFastInterface.html" title="Exactly the same as SimpleTmiInterface except that this uses the digitalWriteFast library on AVR proc...">SimpleTmiFastInterface</a></code> as a template argument, each LED Module generate a new template instance of the <code>Tm1637Module</code> class.</p>
<p>When there are more than some number of TM1636 LED modules, it may actually be more efficient to use the non-fast <code><a class="el" href="classace__tmi_1_1SimpleTmiInterface.html" title="Class that knows how to communicate with a TM1637 chip.">SimpleTmiInterface</a></code>, because you will generate only a single template instantiation. I have not currently done any experiments to see where the break-even point would be.</p>
<p>The <code>delayMicroseconds()</code> may not be accurate for small values on some processors (e.g. AVR) . The actual minimum value of T_DELAY_MICROS will depend on the capacitance and resistance on the DIO and CLK lines, and the accuracy of the <code>delayMicroseconds()</code> function.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T_DIO_PIN</td><td>pin attached to the data line </td></tr>
    <tr><td class="paramname">T_CLK_PIN</td><td>pin attached to the clock line </td></tr>
    <tr><td class="paramname">T_DELAY_MICROS</td><td>delay after each bit transition of DIO or CLK </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="SimpleTmiFastInterface_8h_source.html#l00075">75</a> of file <a class="el" href="SimpleTmiFastInterface_8h_source.html">SimpleTmiFastInterface.h</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a988aa1e7815f234a171b8bce82ee945d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a988aa1e7815f234a171b8bce82ee945d">&#9670;&nbsp;</a></span>begin()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;uint8_t T_DIO_PIN, uint8_t T_CLK_PIN, uint8_t T_DELAY_MICROS&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classace__tmi_1_1SimpleTmiFastInterface.html">ace_tmi::SimpleTmiFastInterface</a>&lt; T_DIO_PIN, T_CLK_PIN, T_DELAY_MICROS &gt;::begin </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize the dio and clk pins. </p>
<p>These are open-drain lines, with pull-up resistors. We must not drive them HIGH actively since that could damage the transitor at the other end of the line pulling LOW. Instead, we go into INPUT mode to let the line to HIGH through the pullup resistor, then go to OUTPUT mode only to pull down. </p>

<p class="definition">Definition at line <a class="el" href="SimpleTmiFastInterface_8h_source.html#l00088">88</a> of file <a class="el" href="SimpleTmiFastInterface_8h_source.html">SimpleTmiFastInterface.h</a>.</p>

</div>
</div>
<a id="a5f47efb6173c6dc0fa8d08d5260749de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f47efb6173c6dc0fa8d08d5260749de">&#9670;&nbsp;</a></span>write()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;uint8_t T_DIO_PIN, uint8_t T_CLK_PIN, uint8_t T_DELAY_MICROS&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t <a class="el" href="classace__tmi_1_1SimpleTmiFastInterface.html">ace_tmi::SimpleTmiFastInterface</a>&lt; T_DIO_PIN, T_CLK_PIN, T_DELAY_MICROS &gt;::write </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Send the data byte on the data bus, with LSB first instead of the usual MSB first for I2C. </p>
<p>This loop generates slightly asymmetric logic signals because clockLow() lasts for 2*bitDelay(), but clockHigh() lasts for only 1*bitDelay(). This does not seem to cause any problems with the LED modules that I have tested.</p>
<dl class="section return"><dt>Returns</dt><dd>1 if device responded with ACK, 0 for NACK. (This retains consistency with AceWire's <code><a class="el" href="classace__tmi_1_1SimpleTmiFastInterface.html#a5f47efb6173c6dc0fa8d08d5260749de" title="Send the data byte on the data bus, with LSB first instead of the usual MSB first for I2C.">write()</a></code> method which returns the number of bytes transfered.) </dd></dl>

<p class="definition">Definition at line <a class="el" href="SimpleTmiFastInterface_8h_source.html#l00133">133</a> of file <a class="el" href="SimpleTmiFastInterface_8h_source.html">SimpleTmiFastInterface.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/home/brian/src/AceTMI/src/ace_tmi/<a class="el" href="SimpleTmiFastInterface_8h_source.html">SimpleTmiFastInterface.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
